<body id="i4mr">
  <div class="wrapper">
	<div class="panel">
	  <div class="top-block">
		<h2 id="ibnt">Admin panel
		</h2>
		<input id="form-input-depositPreSaleTokens-tokenAmount" type="text" placeholder="Enter sum in wei (18 dec)" data-form-name="depositPreSaleTokens" data-field-type="uint256" class="form-control"/>
		<button id="approveButton" type="button" onclick="approve()" class="buttons">Approve</button>
		<button type="button" data-form-name="depositPreSaleTokens" class="buttons">
		  Deposit tokens
		</button>
		<button type="button" data-form-name="withdrawFunds" class="buttons">
		  Widthdraw USDT
		</button>
	  </div>
	</div>
	<div class="p-2">
	  <span id="form-output-getPreSaleToken-0" data-form-name="getPreSaleToken" data-field-type="address">address</span>
	  <span id="form-output-getPreSaleContractAddress-0" data-form-name="getPreSaleContractAddress" data-field-type="address">address</span>
	  <span id="form-output-getStartTimeStamp-0" data-form-name="getStartTimeStamp" data-field-type="uint256">uint256</span>
	  <span id="form-output-getEndTimeStamp-0" data-form-name="getEndTimeStamp" data-field-type="uint256">uint256</span>
	</div>
  </div>
  <form id="form-getPreSaleContractAddress" class="autoreq">
	<button type="button" data-form-name="getPreSaleContractAddress" class="btn btn-primary mt-2">GetPresaleContractAdress</button>
  </form>
  <form id="form-getStartTimeStamp" class="autoreq">
	<button type="button" data-form-name="getStartTimeStamp" class="btn btn-primary mt-2">
	  getStartTimeStamp
	</button>
  </form>
  <form id="form-getPreSaleToken" class="autoreq">
	<button type="button" data-form-name="getPreSaleToken" class="btn btn-primary mt-2">
	  getPreSaleToken
	</button>
  </form>
  <form id="form-getEndTimeStamp" class="autoreq">
	<button type="button" data-form-name="getEndTimeStamp" class="btn btn-primary mt-2">
	  getEndTimeStamp
	</button>
  </form>
  <form id="form-getGoalUsdt" class="autoreq">
	<button type="button" data-form-name="getGoalUsdt" class="btn btn-primary mt-2">
	  getGoalUsdt
	</button>
  </form>
  <form id="form-getTotalUsdtCollected" class="autoreq">
	<button type="button" data-form-name="getTotalUsdtCollected" class="btn btn-primary mt-2">
	  getTotalUsdtCollected
	</button>
  </form>
  <script>
	function refresh(value) {
	  document
		.querySelector(
		`#form-${value}
button`
	  )
		.click();
	}
	async function approve() {
	  const contractAddress = document.querySelector("#form-output-getPreSaleToken-0").innerText;
	  const spenderAddress = document.querySelector("#form-output-getPreSaleContractAddress-0").innerText;
	  const tokenAmount = document.querySelector("#form-input-depositPreSaleTokens-tokenAmount").value;
	  console.log("approve Tokens button is clicked");
	  console.log("Token Amount: " + tokenAmount);
	  try {
		document.getElementById("approveButton").innerHTML = `<div class="spinner-grow spinner-grow-sm" role="status"></div>`;
		const abi = [{
		  "inputs": [{
			"internalType": "address", "name": "spender", "type": "address"
		  }
					 ,
					 {
					   "internalType": "uint256", "name": "amount", "type": "uint256"
					 }
					],
		  "name": "approve",
		  "outputs": [{
			"internalType": "bool", "name": "", "type": "bool"
		  }
					 ],
		  "stateMutability": "nonpayable",
		  "type": "function"
		}
					];
		const provider = new ethers.providers.Web3Provider(this.parent.ethereum);
		const signer = provider.getSigner();
		const contract = new ethers.Contract(contractAddress, abi, signer);
		const amount = tokenAmount
		console.log("Parsed token amount: " + amount);
		const approveTx = await contract.approve(spenderAddress, amount);
		await approveTx.wait();
		alert("Successfully approved");
	  }
	  catch (e) {
		console.error("Error: ", e);
		document.getElementById("approveButton").innerHTML = 'Approve';
		alert("Transaction failed: " + e.message);
	  }
	}
	async function main() {
	  refresh("getStartTimeStamp");
	  refresh("getEndTimeStamp");
	  refresh("getGoalUsdt");
	  refresh("getTotalUsdtCollected");
	  refresh("getPreSaleToken");
	  refresh("getPreSaleContractAddress");
	}
	setTimeout(main, 200);
  </script>
  <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"></script>
</body>